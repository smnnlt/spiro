<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spiro">
<title>Import &amp; Processing • spiro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import &amp; Processing">
<meta property="og:description" content="spiro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spiro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/import_processing.html">Import &amp; Processing</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/summarizing_plotting.html">Summarizing &amp; Plotting</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/smnnlt/spiro">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="import_processing_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Import &amp; Processing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/smnnlt/spiro/blob/HEAD/vignettes/import_processing.Rmd" class="external-link"><code>vignettes/import_processing.Rmd</code></a></small>
      <div class="d-none name"><code>import_processing.Rmd</code></div>
    </div>

    
    
<p>Different measuring devices and analysis software lead to opaque results in measuring gas exchange parameters. To make exercise science more transparent and reproducible, the <code>spiro</code> package offers a standardized workflow for data from cardiopulmonary exercise testing.</p>
<p>This vignette provides information on how the <code>spiro</code> package imports and processes raw data from metabolic carts.</p>
<div class="section level2">
<h2 id="spiro-function">Import and processing with <code>spiro()</code><a class="anchor" aria-label="anchor" href="#spiro-function"></a>
</h2>
<p>The <code>spiro</code> package makes import and processing of cardiopulmonary data easy: The <code><a href="../reference/spiro.html">spiro()</a></code> function does all that work for you. You just need to paste the path of a file with raw data from cardiopulmonary exercise testing to the function. This will return a <code>data.frame</code> containing all relevant data for each second of testing, ready for <a href="https://smnnlt.github.io/spiro/articles/summarising_plotting.html">summarizing or plotting</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/smnnlt/spiro" class="external-link">spiro</a></span><span class="op">)</span>

<span class="co"># Get example data</span>
<span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro_example.html">spiro_example</a></span><span class="op">(</span><span class="st">"zan_gxt"</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
<span class="co">#&gt;    load step time    VO2   VCO2    RR   VT    VE HR PetO2 PetCO2 VO2_rel</span>
<span class="co">#&gt; 1     0    0    1     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 2     0    0    2     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 3     0    0    3     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 4     0    0    4 399.08 323.70 13.94 0.77 10.72 NA    NA     NA    6.05</span>
<span class="co">#&gt; 5     0    0    5 409.83 330.26 14.50 0.74 10.66 NA    NA     NA    6.21</span>
<span class="co">#&gt; 6     0    0    6 420.58 336.82 15.06 0.71 10.60 NA    NA     NA    6.37</span>
<span class="co">#&gt; 7     0    0    7 431.33 343.37 15.63 0.68 10.53 NA    NA     NA    6.54</span>
<span class="co">#&gt; 8     0    0    8 435.30 346.51 16.06 0.69 11.04 NA    NA     NA    6.60</span>
<span class="co">#&gt; 9     0    0    9 437.02 348.52 16.46 0.71 11.74 NA    NA     NA    6.62</span>
<span class="co">#&gt; 10    0    0   10 438.74 350.53 16.85 0.74 12.44 NA    NA     NA    6.65</span>
<span class="co">#&gt;    VCO2_rel RE  RER  CHO   FO</span>
<span class="co">#&gt; 1        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 2        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 3        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 4      4.90 NA 0.81 0.20 0.13</span>
<span class="co">#&gt; 5      5.00 NA 0.81 0.19 0.13</span>
<span class="co">#&gt; 6      5.10 NA 0.80 0.19 0.14</span>
<span class="co">#&gt; 7      5.20 NA 0.80 0.18 0.15</span>
<span class="co">#&gt; 8      5.25 NA 0.80 0.18 0.15</span>
<span class="co">#&gt; 9      5.28 NA 0.80 0.19 0.15</span>
<span class="co">#&gt; 10     5.31 NA 0.80 0.19 0.15</span>
<span class="co">#&gt; ... with 2999 more rows</span></code></pre></div>
<p><code><a href="../reference/spiro.html">spiro()</a></code> will return interpolated data for the following parameters:</p>
<ul>
<li>
<strong>load</strong>: velocity or power, either retrieved from the raw data file or manually supplied by <a href="#protocol-set">setting a protocol</a>
</li>
<li>
<strong>step</strong>: coded variable for the number of the load step in the test protocol</li>
<li>
<strong>time</strong>: time (s)</li>
<li>
<strong>VO2</strong>: oxygen uptake (ml/min)</li>
<li>
<strong>VCO2</strong>: carbon dioxide output (ml/min)</li>
<li>
<strong>RR</strong>: respiratory rate (1/min)</li>
<li>
<strong>VT</strong>: tidal volume (l)</li>
<li>
<strong>VE</strong>: minute ventilation (l/min)</li>
<li>
<strong>HR</strong>: heart rate (bpm), if available</li>
<li>
<strong>PetO2</strong>: end-tidal partial pressure of oxygen (mmHg)</li>
<li>
<strong>PetCO2</strong>: end-tidal partial pressure of carbon dioxide (mmHg)</li>
<li>
<strong>VO2_rel</strong>: relative oxygen uptake (ml/min/kg)</li>
<li>
<strong>VCO2_rel</strong>: relative carbon dioxide output (ml/min/kg)</li>
<li>
<strong>RE</strong>: running economy (ml/kg/km), if applicable</li>
<li>
<strong>RER</strong>: respiratory quotient</li>
<li>
<strong>CHO</strong>: rate of carbohydrate oxidation (g/min)</li>
<li>
<strong>FO</strong>: rate of fat oxidation (g/min)</li>
</ul>
<div class="section level3">
<h3 id="options">Options for data processing<a class="anchor" aria-label="anchor" href="#options"></a>
</h3>
<p>You can control the exercise protocol, the calculation of parameters related to body weight and the adding of heart rate data with the arguments of <code><a href="../reference/spiro.html">spiro()</a></code> or with the helper functions <code>add_protocol</code>, <code><a href="../reference/add_weight.html">add_weight()</a></code> and <code><a href="../reference/add_hr.html">add_hr()</a></code> within a piping syntax:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Note: The Base R pipe requires R version 4.1 or greater</span>

<span class="va">protocol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_protocol.html">set_protocol</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/set_protocol.html">wu</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="fl">120</span>, load <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/set_protocol.html">steps</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="fl">30</span>, load <span class="op">=</span> <span class="fl">100</span>, increment <span class="op">=</span> <span class="fl">20</span>, count <span class="op">=</span> <span class="fl">24</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="../reference/spiro_example.html">spiro_example</a></span><span class="op">(</span><span class="st">"zan_ramp"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="../reference/add_weight.html">add_weight</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fl">63.4</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="../reference/add_protocol.html">add_protocol</a></span><span class="op">(</span><span class="va">protocol</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="../reference/add_hr.html">add_hr</a></span><span class="op">(</span>hr_file <span class="op">=</span> <span class="fu"><a href="../reference/spiro_example.html">spiro_example</a></span><span class="op">(</span><span class="st">"hr_ramp.tcx"</span><span class="op">)</span>, hr_offset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-breath-by-breath-data">Use breath-by-breath data!<a class="anchor" aria-label="anchor" href="#use-breath-by-breath-data"></a>
</h3>
<p>We highly recommended to import only raw breath-by-breath data for several reasons:</p>
<ul>
<li>Prior averaging or interpolation happens outside of R and is therefore a non-reproducible data processing step.</li>
<li>If no data for single breaths is available, some functionality is lost (e.g. breath-based averaging for VO2max determination).</li>
<li>Prior processing usually leads to data containing less data points, which hinders the automated guessing of exercise protocols based on the available load data.</li>
</ul>
<p>If you use a metabolic cart that measures, but does not output data on a breath-by-breath basis, read the manufacturer’s instruction on how to export the raw data in such a way. Data from other systems (e.g., mixed chamber) can still be processed with the <code>spiro</code>-package, but protocol guesses and summary calculations have to be treated with caution.</p>
</div>
</div>
<div class="section level2">
<h2 id="metabolic-carts">Supported metabolic carts<a class="anchor" aria-label="anchor" href="#metabolic-carts"></a>
</h2>
<p>The <code>spiro</code> package supports different metabolic carts. The metabolic cart a data file is produced by is usually determined automatically, but can also be set manually in the <code><a href="../reference/spiro.html">spiro()</a></code> function. Currently this package supports the following devices:</p>
<ul>
<li>
<strong>CORTEX</strong> (<code>"cortex"</code>): .xlsx, .xls or .xml files in English or German language</li>
<li>
<strong>COSMED</strong> (<code>"cosmed"</code>): .xlsx or .xls files in English or German language</li>
<li>
<strong>VYNTUS</strong> (<code>"vyntus"</code>): .txt files (tab-separated) in German language</li>
<li>
<strong>ZAN</strong> (<code>"zan"</code>): .dat files, usually with the name "EXED*" in German language</li>
</ul>
<p>To only import the raw data without further processing (such as interpolation, exercise protocol guessing,…) use the function <code><a href="../reference/spiro_import.html">spiro_import()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiro_import.html">spiro_import</a></span><span class="op">(</span><span class="va">file</span>, device <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt;     time VO2 VCO2    RR   VT    VE HR load PetO2 PetCO2</span>
<span class="co">#&gt; 1   3.44 393  320 13.62 0.79 10.76 NA    0    NA     NA</span>
<span class="co">#&gt; 2   7.25 434  345 15.76 0.67 10.51 NA    0    NA     NA</span>
<span class="co">#&gt; 3  10.73 440  352 17.14 0.76 12.96 NA    0    NA     NA</span>
<span class="co">#&gt; 4  13.97 582  451 18.63 0.65 12.13 NA    0    NA     NA</span>
<span class="co">#&gt; 5  17.20 837  677 18.47 1.07 19.71 NA    0    NA     NA</span>
<span class="co">#&gt; 6  20.39 902  753 18.87 1.19 22.42 NA    0    NA     NA</span>
<span class="co">#&gt; 7  24.37 391  338 15.08 1.01 15.23 NA    0    NA     NA</span>
<span class="co">#&gt; 8  28.00 503  428 16.52 0.69 11.45 NA    0    NA     NA</span>
<span class="co">#&gt; 9  32.06 246  214 14.78 0.61  8.97 NA    0    NA     NA</span>
<span class="co">#&gt; 10 34.65 728  605 23.25 0.54 12.46 NA    0    NA     NA</span>
<span class="co">#&gt; ... with 1987 more rows</span></code></pre></div>
<p>Alternatively you can access the raw data after a <code><a href="../reference/spiro.html">spiro()</a></code> call by extracting the <code>"raw"</code> attribute of the result.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s</span>,<span class="st">"raw"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="protocols">Exercise protocols<a class="anchor" aria-label="anchor" href="#protocols"></a>
</h2>
<p>To achieve the full functionality of data summary and plotting with the <code>spiro</code> package, an exercise protocol needs to be attached to the data.</p>
<div class="section level3">
<h3 id="protocol-get">Protocol guessing<a class="anchor" aria-label="anchor" href="#protocol-get"></a>
</h3>
<p>By default, <code><a href="../reference/spiro.html">spiro()</a></code> guesses the exercise protocol using <code><a href="../reference/get_protocol.html">get_protocol()</a></code>, looking for velocity or load data in the imported raw data. To return the protocol guess after a <code><a href="../reference/spiro.html">spiro()</a></code> call, access the <code>"protocol"</code> attribute.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s</span>,<span class="st">"protocol"</span><span class="op">)</span>
<span class="co">#&gt;    duration load          type code</span>
<span class="co">#&gt; 1        60  0.0  pre measures    0</span>
<span class="co">#&gt; 2       300  2.0          load    1</span>
<span class="co">#&gt; 3        30  0.0          rest   -1</span>
<span class="co">#&gt; 4       300  2.4          load    2</span>
<span class="co">#&gt; 5        30  0.0          rest   -1</span>
<span class="co">#&gt; 6       300  2.8          load    3</span>
<span class="co">#&gt; 7        30  0.0          rest   -1</span>
<span class="co">#&gt; 8       300  3.2          load    4</span>
<span class="co">#&gt; 9        30  0.0          rest   -1</span>
<span class="co">#&gt; 10      300  3.6          load    5</span>
<span class="co">#&gt; 11       30  0.0          rest   -1</span>
<span class="co">#&gt; 12      300  4.0          load    6</span>
<span class="co">#&gt; 13       30  0.0          rest   -1</span>
<span class="co">#&gt; 14      300  4.4          load    7</span>
<span class="co">#&gt; 15       30  0.0          rest   -1</span>
<span class="co">#&gt; 16      300  4.8          load    8</span>
<span class="co">#&gt; 17       30  0.0          rest   -1</span>
<span class="co">#&gt; 18      300  5.2          load    9</span>
<span class="co">#&gt; 19       10  0.0 post measures   -2</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="protocol-set">Protocol setting<a class="anchor" aria-label="anchor" href="#protocol-set"></a>
</h3>
<p>In cases where no load data is saved in the metabolic cart’s file or <code><a href="../reference/get_protocol.html">get_protocol()</a></code> turns wrong, a protocol can be manually set.</p>
<p>There are two ways to initially generate a protocol: by providing all load-duration combinations with <code><a href="../reference/set_protocol_manual.html">set_protocol_manual()</a></code> or by using the helper functions within <code><a href="../reference/set_protocol.html">set_protocol()</a></code>. Once a protocol has been set, it can be used as the <code>protocol</code> argument in a <code><a href="../reference/spiro.html">spiro()</a></code> call or attached to a <code>spiro</code> data frame with <code><a href="../reference/add_protocol.html">add_protocol()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># manually setting a test protocol</span>
<span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_protocol_manual.html">set_protocol_manual</a></span><span class="op">(</span>
  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span>,<span class="fl">30</span>,<span class="fl">300</span><span class="op">)</span>,
  load <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">3.2</span>,<span class="fl">0</span>,<span class="fl">3.4</span>,<span class="fl">0</span>,<span class="fl">3.6</span>,<span class="fl">0</span>,<span class="fl">3.8</span>,<span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">4.2</span>,<span class="fl">0</span>,<span class="fl">4.4</span>,<span class="fl">0</span>,<span class="fl">4.6</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># attach protocol within spiro call</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span>, protocol <span class="op">=</span> <span class="va">pt</span><span class="op">)</span>

<span class="co"># attach protocol with `add_protocol`</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
<span class="fu"><a href="../reference/add_protocol.html">add_protocol</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">pt</span><span class="op">)</span>
<span class="co">#&gt;    load step time    VO2   VCO2    RR   VT    VE HR PetO2 PetCO2 VO2_rel</span>
<span class="co">#&gt; 1     0    0    1     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 2     0    0    2     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 3     0    0    3     NA     NA    NA   NA    NA NA    NA     NA      NA</span>
<span class="co">#&gt; 4     0    0    4 399.08 323.70 13.94 0.77 10.72 NA    NA     NA    6.05</span>
<span class="co">#&gt; 5     0    0    5 409.83 330.26 14.50 0.74 10.66 NA    NA     NA    6.21</span>
<span class="co">#&gt; 6     0    0    6 420.58 336.82 15.06 0.71 10.60 NA    NA     NA    6.37</span>
<span class="co">#&gt; 7     0    0    7 431.33 343.37 15.63 0.68 10.53 NA    NA     NA    6.54</span>
<span class="co">#&gt; 8     0    0    8 435.30 346.51 16.06 0.69 11.04 NA    NA     NA    6.60</span>
<span class="co">#&gt; 9     0    0    9 437.02 348.52 16.46 0.71 11.74 NA    NA     NA    6.62</span>
<span class="co">#&gt; 10    0    0   10 438.74 350.53 16.85 0.74 12.44 NA    NA     NA    6.65</span>
<span class="co">#&gt;    VCO2_rel RE  RER  CHO   FO</span>
<span class="co">#&gt; 1        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 2        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 3        NA NA   NA   NA   NA</span>
<span class="co">#&gt; 4      4.90 NA 0.81 0.20 0.13</span>
<span class="co">#&gt; 5      5.00 NA 0.81 0.19 0.13</span>
<span class="co">#&gt; 6      5.10 NA 0.80 0.19 0.14</span>
<span class="co">#&gt; 7      5.20 NA 0.80 0.18 0.15</span>
<span class="co">#&gt; 8      5.25 NA 0.80 0.18 0.15</span>
<span class="co">#&gt; 9      5.28 NA 0.80 0.19 0.15</span>
<span class="co">#&gt; 10     5.31 NA 0.80 0.19 0.15</span>
<span class="co">#&gt; ... with 2999 more rows</span></code></pre></div>
<p>With <code><a href="../reference/set_protocol.html">set_protocol()</a></code> a protocol can be defined without specifying every single load step. You can paste the pre-defined segment types <code><a href="../reference/set_protocol.html">pre()</a></code>, <code><a href="../reference/set_protocol.html">wu()</a></code>, <code><a href="../reference/set_protocol.html">const()</a></code>and <code><a href="../reference/set_protocol.html">steps()</a></code> into <code><a href="../reference/set_protocol.html">set_protocol()</a></code> in the desired order. The following graph illustrates an example of this practice:</p>
<p><img src="import_processing_files/figure-html/set_protocol-variables-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/set_protocol.html">set_protocol</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_protocol.html">pre</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="../reference/set_protocol.html">wu</a></span><span class="op">(</span><span class="fl">300</span>,<span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="../reference/set_protocol.html">steps</a></span><span class="op">(</span><span class="fl">180</span>,<span class="fl">100</span>,<span class="fl">25</span>,<span class="fl">6</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    duration load</span>
<span class="co">#&gt; 1        60    0</span>
<span class="co">#&gt; 2       300   80</span>
<span class="co">#&gt; 3       180  100</span>
<span class="co">#&gt; 4        30    0</span>
<span class="co">#&gt; 5       180  125</span>
<span class="co">#&gt; 6        30    0</span>
<span class="co">#&gt; 7       180  150</span>
<span class="co">#&gt; 8        30    0</span>
<span class="co">#&gt; 9       180  175</span>
<span class="co">#&gt; 10       30    0</span>
<span class="co">#&gt; 11      180  200</span>
<span class="co">#&gt; 12       30    0</span>
<span class="co">#&gt; 13      180  225</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="weight">Modify body weight<a class="anchor" aria-label="anchor" href="#weight"></a>
</h2>
<p>The <code>spiro</code> package calculates parameters relative to body weight. Per default <code><a href="../reference/spiro.html">spiro()</a></code> will look for information on body weight in the meta data of the original data file. If for some reason no or the wrong weight is present in the raw data file, <code>weight</code> can be manually given as an argument in <code><a href="../reference/spiro.html">spiro()</a></code> or with <code><a href="../reference/add_weight.html">add_weight()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set body weight as an argument in `spiro()`</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span>, weight <span class="op">=</span> <span class="fl">68.3</span><span class="op">)</span>

<span class="co"># set body weight using `add_weight()`</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span> 
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_weight.html">add_weight</a></span><span class="op">(</span><span class="va">t</span>, <span class="fl">68.3</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="heart-rate">Work with external heart rate data<a class="anchor" aria-label="anchor" href="#heart-rate"></a>
</h2>
<p>Some metabolic carts only offer complicated options for connecting them to heart rate monitors. If heart rate data was recorded by another kind of device (e.g. wrist watch), this data can be added within the <code><a href="../reference/spiro.html">spiro()</a></code> call or by using <code><a href="../reference/add_hr.html">add_hr()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get example data file path</span>
<span class="va">hpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro_example.html">spiro_example</a></span><span class="op">(</span><span class="st">"hr_ramp.tcx"</span><span class="op">)</span>

<span class="co"># add heart rate data within `spiro()`</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span>, hr_file <span class="op">=</span> <span class="va">hpath</span>, hr_offset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># add heart rate data with `add_hr()`</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spiro.html">spiro</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
<span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_hr.html">add_hr</a></span><span class="op">(</span><span class="va">i</span>, hr_file <span class="op">=</span> <span class="va">hpath</span>, hr_offset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/add_hr.html">add_hr()</a></code> will import the heart rate data from a .tcx file and attach it to the existing data set. You can manually set the starting point of the heart rate recording relative to the start of the gas exchange measures recording with the <code>hr_offset</code> argument.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Simon Nolte.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
